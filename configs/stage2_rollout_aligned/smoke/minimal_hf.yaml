extends: ../base.yaml

# Minimal smoke for Stage-2 rollout-aligned teacher forcing (HF backend).
#
# Goal: validate contracts + objective-atom additivity in a few steps without vLLM.

model:
  # Update as needed for your environment.
  model: output/12-24/coord_loss-merged/ckpt-3106

training:
  run_name: smoke_stage2_rollout_aligned_hf
  output_dir: output/stage2_rollout_aligned/smoke/hf_minimal
  logging_dir: tb/stage2_rollout_aligned/smoke/hf_minimal
  max_steps: 2
  logging_steps: 1
  logging_first_step: true
  eval_strategy: "no"
  save_strategy: "no"

data:
  dataset: [dummy]
  val_dataset: [dummy]
  dataset_num_proc: 1
  dataloader_num_workers: 0
  dataloader_pin_memory: false
  dataloader_prefetch_factor: null
  dataloader_persistent_workers: false

custom:
  train_jsonl: public_data/coco/rescale_32_768_bbox_max60/train.coord.jsonl
  val_jsonl: public_data/coco/rescale_32_768_bbox_max60/val.coord.jsonl
  train_sample_limit: 32
  val_sample_limit: 8
  extra:
    prompt_variant: coco_80

rollout_matching:
  rollout_backend: hf
  decode_batch_size: 2
  max_new_tokens: 256
  eval_detection:
    enabled: false

