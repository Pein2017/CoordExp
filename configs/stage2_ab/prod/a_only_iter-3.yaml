# Stage-2 AB ablation: Channel-A only (expectation loop), epoch=2.
# Only the stage2_ab schedule differs from other ablation variants.
extends: a_only_base.yaml

training:
  output_dir: output/stage2_ab/prod_bbox_max60_ckpt1516_ablation_ep2/a_only_iter3
  logging_dir: tb/stage2_ab/prod_bbox_max60_ckpt1516_ablation_ep2/a_only_iter3
  run_name: prod_a_only_bbox_max60_ckpt1516_ep2_iter3
  # A-only ablation doesn't use Channel-B rollouts; avoid triggering rollout-based eval
  # (which would require a vLLM rollout backend).
  eval_strategy: "no"
  do_eval: false

stage2_ab:
  # Disable async Channel-B (server-rollout-only) so A-only runs don't require a vLLM server.
  # NOTE: Because configs deep-merge, also null out the async subsection inherited from prod/base.yaml.
  channel_b:
    mode: micro
    async: null
  n_softctx_iter: 3

custom:
  extra:
    # Safety: if any code path tries to rollout (e.g., accidental eval), use HF generate.
    rollout_matching:
      rollout_backend: hf
