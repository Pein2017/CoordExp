# Stage-2 AB training (bbox-only v1): Channel-A only (iterative soft self-context)
#
# This is a minimal YAML example intended for smoke testing the trainer wiring.

extends: rollout_matching_sft_template.yaml

stage2_ab:
  schedule:
    b_ratio: 0.0
  n_softctx_iter: 2
  desc_ce_weight: 1.0
  bbox_smoothl1_weight: 1.0
  bbox_ciou_weight: 1.0
  softctx_temperature: 1.0
  # Required by the Stage-2 AB typed config (even when Channel-B is not used).
  channel_b:
    semantic_desc_gate:
      enabled: true
      model_name_or_path: sentence-transformers/all-MiniLM-L6-v2
      threshold: 0.5
      revision: c9745ed1d9f207416be6d2e6f8de32d1f16199bf

custom:
  trainer_variant: stage2_ab_training

  # Bbox-only LVIS dataset (coord-token JSONL).
  train_jsonl: public_data/lvis/rescale_32_768_bbox_max60/train.bbox_only.max60.coord.jsonl
  val_jsonl: public_data/lvis/rescale_32_768_bbox_max60/val.bbox_only.max60.coord.jsonl

  # Rollout config is unused in A-only runs, but kept for schema compatibility.
