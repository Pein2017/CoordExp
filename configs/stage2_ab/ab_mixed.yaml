# Stage-2 AB training (bbox-only v1): Mixed A/B schedule

extends: rollout_matching_sft_template.yaml

custom:
  trainer_variant: stage2_ab_training

  # Bbox-only LVIS dataset (coord-token JSONL).
  train_jsonl: public_data/lvis/rescale_32_768_bbox_max60/train.bbox_only.max60.coord.jsonl
  val_jsonl: public_data/lvis/rescale_32_768_bbox_max60/val.bbox_only.max60.coord.jsonl

  extra:
    stage2_ab:
      schedule:
        # Channel-B should be sparse (~5%) to stay a cold path.
        pattern:
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - A
          - B
      n_softctx_iter: 2
      desc_ce_weight: 1.0
      bbox_l1_weight: 1.0
      bbox_giou_weight: 1.0
      softctx_temperature: 1.0
      channel_b:
        reordered_gt_sft: true
        reordered_gt_append_missing: true
        desc_ce_weight_matched: 0.2
