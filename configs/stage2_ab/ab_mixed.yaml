# Stage-2 AB training (bbox-only v1): Mixed A/B schedule

extends: rollout_matching_sft_template.yaml

stage2_ab:
  schedule:
    # Channel-B should be sparse (~5%) to stay a cold path.
    b_ratio: 0.05
  n_softctx_iter: 2
  desc_ce_weight: 1.0
  bbox_smoothl1_weight: 1.0
  bbox_ciou_weight: 1.0
  softctx_temperature: 1.0
  channel_b:
    reordered_gt_sft: false
    desc_ce_weight_matched: 0.2
    semantic_desc_gate:
      enabled: true
      model_name_or_path: sentence-transformers/all-MiniLM-L6-v2
      threshold: 0.5
      revision: c9745ed1d9f207416be6d2e6f8de32d1f16199bf

custom:
  trainer_variant: stage2_ab_training

  # Bbox-only LVIS dataset (coord-token JSONL).
  train_jsonl: public_data/lvis/rescale_32_768_bbox_max60/train.bbox_only.max60.coord.jsonl
  val_jsonl: public_data/lvis/rescale_32_768_bbox_max60/val.bbox_only.max60.coord.jsonl
