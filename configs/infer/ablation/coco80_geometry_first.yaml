# Stage1 ablation infer/eval config (COCO-80, geometry-first prompt fields)
# Usage:
#   PYTHONPATH=. conda run -n ms python scripts/run_infer.py --config configs/infer/ablation/coco80_geometry_first.yaml
run:
  name: stage1_coco80_geometry_first
  output_dir: output/infer

stages:
  infer: true
  eval: true
  vis: false

infer:
  gt_jsonl: public_data/coco/rescale_32_768_bbox_max60/val.coord.jsonl
  # Replace with your merged checkpoint path.
  model_checkpoint: output/stage1/coco_bbox_max60-coco80-geometry_first/REPLACE_WITH_CHECKPOINT

  mode: auto
  pred_coord_mode: auto
  prompt_variant: coco_80
  object_field_order: geometry_first

  backend:
    type: hf

  generation:
    temperature: 0.1
    top_p: 0.9
    max_new_tokens: 3084
    repetition_penalty: 1.1
    batch_size: 8
    seed: 42

  device: cuda:0
  limit: 0
  detect_samples: 128

eval:
  output_dir: null
  metrics: both
  use_segm: false
  overlay: false
  overlay_k: 12
  num_workers: 8
  semantic_model: model_cache/all-MiniLM-L6-v2-local
  semantic_device: cuda:0
  semantic_batch_size: 64
  semantic_threshold: 0.5
